<Window x:Class="chatbot.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Chatbot" Height="700" Width="800"
    WindowStartupLocation="CenterScreen"
    Background="#F5F8FF">
    <!-- Root Grid for the entire window -->
    <Grid>
        <!-- Toggle History Button -->
        <!-- This button allows the user to toggle the visibility of the history panel -->
        <Button x:Name="ToggleHistoryButton"
            Content="Hide History"
            Background="#2563EB"
            Foreground="White"
            FontWeight="Bold"
            FontSize="14"
            Padding="8,4"
            Margin="24,24,0,0"
            BorderThickness="0"
            Cursor="Hand"
            HorizontalAlignment="Left"
            VerticalAlignment="Top"
            Click="ToggleHistoryButton_Click"
            Panel.ZIndex="100" />

        <!-- Main layout grid -->
        <!-- This grid divides the window into two columns: History and Main Chat Area -->
        <Grid Margin="0,60,0,0">
            <Grid.ColumnDefinitions>
                <!-- History column -->
                <ColumnDefinition Width="*" x:Name="HistoryColumn" />
                <!-- Main chat area column -->
                <ColumnDefinition Width="2*" x:Name="MainColumn" />
            </Grid.ColumnDefinitions>

            <!-- History Panel -->
            <!-- This grid contains the history panel where previous questions are displayed -->
            <Grid Grid.Column="0" x:Name="HistoryPanelGrid">
                <Border Background="#E3ECFF" Padding="16" Margin="0,40,0,24" CornerRadius="12">
                    <StackPanel>
                        <!-- Title for the history panel -->
                        <TextBlock Text="History" FontSize="20" FontWeight="Bold"
                            Foreground="#1B3A7A" Margin="0,0,0,16" />
                        <!-- Button to clear the history -->
                        <Button Name="ClearHistoryButton"
                            Content="Clear History"
                            Background="#2563EB"
                            Foreground="White"
                            FontWeight="Bold"
                            FontSize="14"
                            Padding="8,4"
                            Margin="0,0,0,16"
                            BorderThickness="0"
                            Cursor="Hand"
                            Click="ClearHistoryButton_Click" />
                        <!-- Scrollable list of history items -->
                        <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="500">
                            <ItemsControl Name="HistoryItemsPanel">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <!-- Each history item is displayed as a button -->
                                        <Button Content="{Binding Question}"
                                            Margin="0,0,0,8"
                                            Padding="8"
                                            Background="#FFFFFF"
                                            Foreground="#1B3A7A"
                                            BorderBrush="#3B82F6"
                                            BorderThickness="1"
                                            HorizontalContentAlignment="Left"
                                            Cursor="Hand"
                                            Click="HistoryButton_Click"
                                            FontWeight="SemiBold"
                                            FontSize="14" />
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </ScrollViewer>
                    </StackPanel>
                </Border>
            </Grid>

            <!-- Main Chat Area -->
            <!-- This section contains the main chat interface -->
            <Border Grid.Column="1" CornerRadius="16" Padding="32" Background="#FFFFFF" Margin="24">
                <Grid>
                    <Grid.RowDefinitions>
                        <!-- Title row -->
                        <RowDefinition Height="Auto" />
                        <!-- Input row -->
                        <RowDefinition Height="Auto" />
                        <!-- Chat display row -->
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <!-- Title for the chatbot -->
                    <TextBlock Text="AI Chatbot" FontSize="32" FontWeight="Bold"
                        Foreground="#2563EB"
                        Margin="0,0,0,24" HorizontalAlignment="Center" Grid.Row="0" />
                    <!-- Input area for questions -->
                    <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,0,0,16">
                        <!-- TextBox for user input -->
                        <TextBox Name="QuestionTextBox"
                            MinHeight="40"
                            FontSize="16"
                            Padding="10"
                            Background="#F0F6FF"
                            Foreground="#1B3A7A"
                            BorderBrush="#3B82F6"
                            BorderThickness="2"
                            VerticalContentAlignment="Center"
                            ToolTip="Type your question here..."
                            KeyDown="QuestionTextBox_KeyDown"
                            Width="260"
                            Margin="0,0,8,0" />
                        <!-- Button to submit the question -->
                        <Button Name="AskButton"
                            Content="Ask"
                            MinHeight="40"
                            FontSize="16"
                            Background="#2563EB"
                            Foreground="White"
                            BorderThickness="0"
                            Padding="18,0"
                            Cursor="Hand"
                            Click="AskButton_Click"
                            Width="80">
                            <Button.Effect>
                                <!-- Drop shadow effect for the button -->
                                <DropShadowEffect Color="#3B82F6" BlurRadius="8" ShadowDepth="2" />
                            </Button.Effect>
                        </Button>
                    </StackPanel>
                    <!-- Display area for the question and answer -->
                    <Border Background="#E3ECFF" CornerRadius="8" Padding="16" Grid.Row="2"
                        VerticalAlignment="Stretch" HorizontalAlignment="Stretch">
                        <ScrollViewer VerticalScrollBarVisibility="Auto">
                            <StackPanel>
                                <!-- Displayed question -->
                                <TextBlock Text="Question:" FontWeight="Bold" Foreground="#2563EB"
                                    Margin="0,0,0,4" FontSize="16" />
                                <TextBlock Name="DisplayedQuestionTextBlock"
                                    FontSize="15"
                                    Foreground="#1B3A7A"
                                    TextWrapping="Wrap"
                                    Margin="0,0,0,12" />
                                <!-- Displayed answer -->
                                <TextBlock Text="Answer:" FontWeight="Bold" Foreground="#2563EB"
                                    Margin="0,0,0,4" FontSize="16" />
                                <TextBlock Name="AnswerTextBlock"
                                    FontSize="18"
                                    Foreground="#1B3A7A"
                                    TextWrapping="Wrap" />
                            </StackPanel>
                        </ScrollViewer>
                    </Border>
                    <!-- Spinner overlay for loading state -->
                    <Grid x:Name="SpinnerOverlay" Visibility="Collapsed" Background="#80FFFFFF"
                        Grid.RowSpan="3" Panel.ZIndex="999">
                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                            <!-- Rotating spinner -->
                            <Ellipse Width="10" Height="10" Stroke="#2563EB" StrokeThickness="6">
                                <Ellipse.RenderTransform>
                                    <RotateTransform x:Name="SpinnerRotate" Angle="0" />
                                </Ellipse.RenderTransform>
                                <Ellipse.Triggers>
                                    <EventTrigger RoutedEvent="Loaded">
                                        <BeginStoryboard>
                                            <Storyboard RepeatBehavior="Forever">
                                                <DoubleAnimation
                                                    Storyboard.TargetName="SpinnerRotate"
                                                    Storyboard.TargetProperty="Angle"
                                                    From="0" To="360" Duration="0:0:1" />
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Ellipse.Triggers>
                            </Ellipse>
                            <!-- Loading message -->
                            <TextBlock Text="Waiting for response..." Foreground="#2563EB"
                                FontWeight="Bold" FontSize="16" Margin="0,16,0,0"
                                HorizontalAlignment="Center" />
                        </StackPanel>
                    </Grid>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>